---
# YAML Front Matterï¼šæ–‡ç« è¨­å®šå€å¡Š
title: "Google Colab å¯¦ä½œ1: ä¸²æ¥Google Sheetå’ŒGoolgleè¡¨å–®å³æ™‚åˆ†æ"
description: "ç”¨Google Sheetå…¬å¼å¯ä»¥è·‘å‡ºå³æ™‚åˆ†æï¼Œå¯æ˜¯ç•¶è³‡æ–™é‡è¶…é3000ç­†å°±æœƒå¡é “ï¼Œä¸‹è¼‰ä¸‹ä¾†æœ¬åœ°ç«¯ä½¿ç”¨Excelåˆç„¡æ³•å³æ™‚ï¼Œç”¨Pythonæœ¬åœ°ç«¯é‚„è¦è®€å–csvæª”æ¡ˆåˆå¤šäº†åŠå°æ™‚ï¼Œåœ¨å·¥ä½œä¸Šæ€éº¼åšæ‰æ˜¯æœ€å¥½ï¼Ÿ"
categories: ["Coding",'è³‡æ–™åˆ†æ']   # é€™æ˜¯æ‚¨çš„åˆ†é¡ï¼Œå¯ä»¥è‡ªå·±æ±ºå®š
tags: ["Python","Google Colab","Gemini"]           # é€™æ˜¯æ–‡ç« çš„æ¨™ç±¤
---

## ç‚ºä»€éº¼ä½ è©²æ¨æ£„ Excel å…¬å¼ï¼ŸPython èˆ‡ Google Sheets çš„æ•ˆç‡å°æ±º

åœ¨è™•ç† Google å•å·æˆ–å¤§é‡è³‡æ–™æ™‚ï¼Œè¨±å¤šäººç¿’æ…£ä¸æ–·åœ°å †ç–Š Excel å…¬å¼ã€‚ä½†ç•¶è³‡æ–™é‡ä¸€å¤šï¼Œæˆ–æ˜¯é‚è¼¯è®Šè¤‡é›œæ™‚ï¼Œè©¦ç®—è¡¨å¾€å¾€æœƒè®Šæˆä½ çš„å™©å¤¢ã€‚ä¸‹è¡¨å±•ç¤ºäº†ç‚ºä»€éº¼ **Python (Pandas)** æ‰æ˜¯æ•¸æ“šè™•ç†çš„çµ‚æ¥µè§£ç­”ï¼š

### ğŸ“Š æ•ˆç‡å¤§æ¯”æ‹¼ï¼šGoogle Sheets vs. Python

| ç¶­åº¦ | Google Sheets / Excel | Python (Pandas) | æ•ˆç‡å„ªå‹¢ |
| :--- | :--- | :--- | :--- |
| **è™•ç†é€Ÿåº¦** | è¶…éè¬ç­†è³‡æ–™å°±é–‹å§‹å¡é “ã€è½‰åœˆåœˆã€‚ | è¼•é¬†è™•ç†ç™¾è¬ç­‰ç´šè³‡æ–™ï¼Œé‹ç®—ç§’é–‹ã€‚ | ğŸš€ æ¥µé€Ÿ |
| **é‡è¤‡æ€§ä»»å‹™** | æ¯æ¬¡éƒ½è¦æ‰‹å‹•ã€Œè¤‡è£½ã€è²¼ä¸Šã€é‡æ–°æ‹‰å…¬å¼ã€ã€‚ | å¯«å¥½è…³æœ¬ï¼Œä¸‹æ¬¡ä¸€éµåŸ·è¡Œå…¨è‡ªå‹•è™•ç†ã€‚ | ğŸ¤– è‡ªå‹•åŒ– |
| **é‚è¼¯è¤‡é›œåº¦** | å·¢ç‹€å…¬å¼ `IF(AND(OR(...)))` é›£ä»¥é–±è®€èˆ‡é™¤éŒ¯ã€‚ | é‚è¼¯æ¸…æ™°ï¼Œç¨‹å¼ç¢¼åƒè‹±æ–‡å¥å­ä¸€æ¨£å¥½æ‡‚ã€‚ | ğŸ§  é‚è¼¯åŒ– |
| **è³‡æ–™æ¸…ç†** | éœ€æ‰‹å‹•åˆªé™¤ç©ºç™½æ ¼ã€è™•ç†äº‚ç¢¼ï¼Œè€—æ™‚è²»åŠ›ã€‚ | ä¸€è¡Œ `df.dropna()` æˆ– `df.replace()` æå®šã€‚ | ğŸ§¹ é›¶è² æ“” |
| **å³æ™‚åŒæ­¥** | éœ€è¦ä¸æ–·æ‰‹å‹•ä¸‹è¼‰ CSV æª”æ¡ˆã€‚ | é€é API ç›´æ¥è®€å–é›²ç«¯è³‡æ–™ï¼Œæ°¸é ä¿æŒæœ€æ–°ã€‚ | âš¡ é›¶æ™‚å·® |

---

## å¯¦æˆ°æ•™å­¸ï¼šåœ¨ Google Colab å°å…¥å³æ™‚å•å·è³‡æ–™

ä½¿ç”¨ Python è™•ç†è³‡æ–™ä¸¦ä¸é›£ï¼ŒGoogle Colab å·²ç¶“å¹«æˆ‘å€‘æº–å‚™å¥½äº†æ‰€æœ‰ç’°å¢ƒã€‚ä½ åªéœ€è¦ä»¥ä¸‹å¹¾è¡Œç¨‹å¼ç¢¼ï¼Œå°±èƒ½æŠŠã€Œæ­£åœ¨ç·¨è¼¯ä¸­ã€çš„ Google Sheet è®Šæˆå¼·å¤§çš„ DataFrameï¼š

### 1. èªè­‰èˆ‡æˆæ¬Š
é¦–å…ˆï¼Œæˆ‘å€‘éœ€è¦è®“ Google Colab å–å¾—å­˜å–ä½ é›²ç«¯ç¡¬ç¢Ÿæª”æ¡ˆçš„æ¬Šé™ã€‚

```python
from google.colab import auth
auth.authenticate_user()

import gspread
from google.auth import compute_engine
from google.auth import default

creds, _ = default()
gc = gspread.authorize(creds)
```

### 2. è®€å–é›²ç«¯è¡¨å–®çµæœ
å°‡é›²ç«¯è¡¨å–®è¼¸å‡ºæˆGoogle Sheetï¼Œæ¥è‘—ç”¨æŒ‡ä»¤è®€å–é€™ä»½è³‡æ–™ã€‚å¯ä»¥ä½¿ç”¨é‡‘é‘°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨å–®åç¨±ã€‚

```python
import pandas as pd

# é€™æ˜¯è®€å–é‡‘é‘°çš„åšæ³•ï¼Œå‰æè¦çŸ¥é“Google Drive é›²ç«¯è³‡æ–™é‡‘é‘°çš„åˆ¤åˆ¥
sh = gc.open_by_key('é€™ä¸²æ˜¯æª”æ¡ˆé‡‘é‘°')

# é€™æ˜¯è®€å–æª”æ¡ˆåç¨±çš„ä½œæ³•ï¼Œçœ‹ä½ å·¦ä¸Šè§’æª”æ¡ˆåç¨±æ˜¯ä»€éº¼è¤‡è£½éä¾†å°±å¯ä»¥äº†ã€‚æœƒæœ‰ä¸€å€‹å•é¡Œï¼Œå¦‚æœä½ ä¸å°å¿ƒåœ¨å…©å€‹ä¸åŒçš„é›²ç«¯è³‡æ–™å¤¾å–äº†ç›¸åŒçš„Google Sheetåç¨±å‘¢ï¼Ÿ
sh = gc.open('æˆ‘æ˜¯æª”æ¡ˆåç¨±ä¸è¦æ‰¾åŒåçš„')

# 0 ä»£è¡¨ç¬¬ä¸€å€‹åˆ†é 
worksheet = sh.get_worksheet(0) 

# æŠ“å–æ‰€æœ‰è³‡æ–™ä¸¦è½‰æ›ç‚º DataFrame
data = worksheet.get_all_values()
df = pd.DataFrame(data[1:], columns=data[0])

# æŸ¥çœ‹è³‡æ–™æƒ…å½¢ï¼Œå­¸éè³‡æ–™åˆ†æéƒ½æ‡‚çš„å°æŠ€å·§
print(df.info())
```
### ï¼“. è½‰æ›æ™‚é–“è³‡æ–™
ä¸­æ–‡çš„Googleè¡¨å–®æ™‚é–“è³‡æ–™æœƒæœ‰"ä¸Šåˆ"ã€"ä¸‹åˆ"çš„å•é¡Œï¼Œä¸€éµè½‰æ›

```python
# æŒ‡å®š format è§£æ±º AM/PM æ”¾ç½®ä½ç½®çš„å•é¡Œ
df['æ™‚é–“æˆ³è¨˜'] = pd.to_datetime(df['æ™‚é–“æˆ³è¨˜'], format='%Y/%m/%d %p %I:%M:%S', errors='coerce')

# æŸ¥çœ‹è½‰æ›çµæœä»¥åŠdtype
print(df['æ™‚é–“æˆ³è¨˜'] )

```

### 4. ç”¨maskæŠ€å·§æŠ“å–æŒ‡å®šæ™‚é–“ä¹‹å¾Œçš„è³‡æ–™åšåˆ†æ

```python
# ç¯©é¸ 2025/9/1 ä¹‹å¾Œ
mask = df['æ™‚é–“æˆ³è¨˜'] >= '2025-09-01'
filtered_df = df[mask]

print(f"2025-09-01ä¹‹å¾Œçš„è³‡æ–™:{len(filtered_df)}")
print(filtered_df.info())

```

### 5. è¶…é500æ¬„çš„è³‡æ–™æ€éº¼è¾¦ï¼Œåˆ—å‡ºç·¨è™ŸæŸ¥çœ‹
è³‡æ–™è¶…é500æ¬„æ€éº¼è¾¦ï¼Œç”¨Google Sheetç¿»çœ‹è¦æ»‘åˆ°çœ¼ç›è„«çª—ï¼Œç”¨ä»¥ä¸‹çš„æŒ‡ä»¤ä¸€éµè¼¸å‡ºæŸ¥çœ‹

```python
# åˆ—å‡ºæ‰€æœ‰æ¬„ä½ï¼Œæ–¹ä¾¿å°ç…§ç·¨è™Ÿ
for i, col in enumerate(filtered_df.columns):
    print(f"Index {i}: {col}")
```

### 6. 300å¤šæ¬„çš„è³‡æ–™å› ç‚ºGoogle è¡¨å–®åˆ†é é—œä¿‚å°è‡´é‡è¤‡åˆå¾ˆå¤šç©ºæ ¼ï¼Œæ€éº¼è¾¦ï¼Ÿ
æŠ“å–é—œéµå­—ï¼Œçµ„åˆè¡¨æ ¼ã€‚æœ¬ä¾†ç”¨Google Sheetè¤‡è£½è²¼ä¸ŠèŠ±ä¸€å‘¨æ™‚é–“ï¼Œ10åˆ†é˜æå®šã€‚


```python
# æŠ“å–ç¬¬ä¸€æ¬„
first_col = [filtered_df.columns[0]]

# æŠ“å–æ‰€æœ‰åŒ…å«èª²ç¨‹é—œéµå­—çš„æ¬„ä½
course_cols = [col for col in filtered_df.columns if "æˆ‘æ˜¯é‡è¤‡çš„è³‡æ–™" in col]

# é‡æ–°çµ„åˆ
final_df = df[first_col + course_cols]

```